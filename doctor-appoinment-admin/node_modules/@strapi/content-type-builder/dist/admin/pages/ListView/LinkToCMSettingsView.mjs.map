{"version":3,"file":"LinkToCMSettingsView.mjs","sources":["../../../../admin/src/pages/ListView/LinkToCMSettingsView.tsx"],"sourcesContent":["import { memo } from 'react';\n\nimport { type Permission, useRBAC } from '@strapi/admin/strapi-admin';\nimport { Button } from '@strapi/design-system';\nimport { ListPlus } from '@strapi/icons';\nimport { useIntl } from 'react-intl';\nimport { useNavigate } from 'react-router-dom';\n\nconst cmPermissions: Record<string, Permission[]> = {\n  collectionTypesConfigurations: [\n    {\n      action: 'plugin::content-manager.collection-types.configure-view',\n      subject: null,\n    },\n  ],\n  componentsConfigurations: [\n    {\n      action: 'plugin::content-manager.components.configure-layout',\n      subject: null,\n    },\n  ],\n  singleTypesConfigurations: [\n    {\n      action: 'plugin::content-manager.single-types.configure-view',\n      subject: null,\n    },\n  ],\n};\n\nconst getPermission = ({\n  isInContentTypeView,\n  contentTypeKind,\n}: {\n  isInContentTypeView: boolean;\n  contentTypeKind: string;\n}) => {\n  if (isInContentTypeView) {\n    if (contentTypeKind === 'singleType') {\n      return cmPermissions.singleTypesConfigurations;\n    }\n\n    return cmPermissions.collectionTypesConfigurations;\n  }\n\n  return cmPermissions.componentsConfigurations;\n};\n\ninterface LinkToCMSettingsViewProps {\n  disabled: boolean;\n  contentTypeKind?: string;\n  isInContentTypeView?: boolean;\n  targetUid?: string;\n}\n\nexport const LinkToCMSettingsView = memo(\n  ({\n    disabled,\n    isInContentTypeView = true,\n    contentTypeKind = 'collectionType',\n    targetUid = '',\n  }: LinkToCMSettingsViewProps) => {\n    const { formatMessage } = useIntl();\n    const navigate = useNavigate();\n    const permissionsToApply = getPermission({ isInContentTypeView, contentTypeKind });\n\n    const label = formatMessage({\n      id: 'content-type-builder.form.button.configure-view',\n      defaultMessage: 'Configure the view',\n    });\n\n    const handleClick = () => {\n      if (disabled) {\n        return false;\n      }\n\n      if (isInContentTypeView) {\n        navigate(`/content-manager/collection-types/${targetUid}/configurations/edit`);\n      } else {\n        navigate(`/content-manager/components/${targetUid}/configurations/edit`);\n      }\n\n      return false;\n    };\n\n    const { isLoading, allowedActions } = useRBAC({\n      viewConfig: permissionsToApply,\n    });\n\n    if (isLoading) {\n      return null;\n    }\n\n    if (!allowedActions.canConfigureView && !allowedActions.canConfigureLayout) {\n      return null;\n    }\n\n    return (\n      <Button startIcon={<ListPlus />} variant=\"tertiary\" onClick={handleClick} disabled={disabled}>\n        {label}\n      </Button>\n    );\n  }\n);\n"],"names":["cmPermissions","collectionTypesConfigurations","action","subject","componentsConfigurations","singleTypesConfigurations","getPermission","isInContentTypeView","contentTypeKind","LinkToCMSettingsView","memo","disabled","targetUid","formatMessage","useIntl","navigate","useNavigate","permissionsToApply","label","id","defaultMessage","handleClick","isLoading","allowedActions","useRBAC","viewConfig","canConfigureView","canConfigureLayout","_jsx","Button","startIcon","ListPlus","variant","onClick"],"mappings":";;;;;;;;AAQA,MAAMA,aAA8C,GAAA;IAClDC,6BAA+B,EAAA;AAC7B,QAAA;YACEC,MAAQ,EAAA,yDAAA;YACRC,OAAS,EAAA;AACX;AACD,KAAA;IACDC,wBAA0B,EAAA;AACxB,QAAA;YACEF,MAAQ,EAAA,qDAAA;YACRC,OAAS,EAAA;AACX;AACD,KAAA;IACDE,yBAA2B,EAAA;AACzB,QAAA;YACEH,MAAQ,EAAA,qDAAA;YACRC,OAAS,EAAA;AACX;AACD;AACH,CAAA;AAEA,MAAMG,gBAAgB,CAAC,EACrBC,mBAAmB,EACnBC,eAAe,EAIhB,GAAA;AACC,IAAA,IAAID,mBAAqB,EAAA;AACvB,QAAA,IAAIC,oBAAoB,YAAc,EAAA;AACpC,YAAA,OAAOR,cAAcK,yBAAyB;AAChD;AAEA,QAAA,OAAOL,cAAcC,6BAA6B;AACpD;AAEA,IAAA,OAAOD,cAAcI,wBAAwB;AAC/C,CAAA;AASaK,MAAAA,oBAAAA,iBAAuBC,IAClC,CAAA,CAAC,EACCC,QAAQ,EACRJ,mBAAsB,GAAA,IAAI,EAC1BC,eAAkB,GAAA,gBAAgB,EAClCI,SAAAA,GAAY,EAAE,EACY,GAAA;IAC1B,MAAM,EAAEC,aAAa,EAAE,GAAGC,OAAAA,EAAAA;AAC1B,IAAA,MAAMC,QAAWC,GAAAA,WAAAA,EAAAA;AACjB,IAAA,MAAMC,qBAAqBX,aAAc,CAAA;AAAEC,QAAAA,mBAAAA;AAAqBC,QAAAA;AAAgB,KAAA,CAAA;AAEhF,IAAA,MAAMU,QAAQL,aAAc,CAAA;QAC1BM,EAAI,EAAA,iDAAA;QACJC,cAAgB,EAAA;AAClB,KAAA,CAAA;AAEA,IAAA,MAAMC,WAAc,GAAA,IAAA;AAClB,QAAA,IAAIV,QAAU,EAAA;YACZ,OAAO,KAAA;AACT;AAEA,QAAA,IAAIJ,mBAAqB,EAAA;AACvBQ,YAAAA,QAAAA,CAAS,CAAC,kCAAkC,EAAEH,SAAAA,CAAU,oBAAoB,CAAC,CAAA;SACxE,MAAA;AACLG,YAAAA,QAAAA,CAAS,CAAC,4BAA4B,EAAEH,SAAAA,CAAU,oBAAoB,CAAC,CAAA;AACzE;QAEA,OAAO,KAAA;AACT,KAAA;AAEA,IAAA,MAAM,EAAEU,SAAS,EAAEC,cAAc,EAAE,GAAGC,OAAQ,CAAA;QAC5CC,UAAYR,EAAAA;AACd,KAAA,CAAA;AAEA,IAAA,IAAIK,SAAW,EAAA;QACb,OAAO,IAAA;AACT;AAEA,IAAA,IAAI,CAACC,cAAeG,CAAAA,gBAAgB,IAAI,CAACH,cAAAA,CAAeI,kBAAkB,EAAE;QAC1E,OAAO,IAAA;AACT;AAEA,IAAA,qBACEC,GAACC,CAAAA,MAAAA,EAAAA;AAAOC,QAAAA,SAAAA,gBAAWF,GAACG,CAAAA,QAAAA,EAAAA,EAAAA,CAAAA;QAAaC,OAAQ,EAAA,UAAA;QAAWC,OAASZ,EAAAA,WAAAA;QAAaV,QAAUA,EAAAA,QAAAA;AACjFO,QAAAA,QAAAA,EAAAA;;AAGP,CACA;;;;"}