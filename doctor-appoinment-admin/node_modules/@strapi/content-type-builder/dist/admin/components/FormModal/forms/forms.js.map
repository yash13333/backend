{"version":3,"file":"forms.js","sources":["../../../../../admin/src/components/FormModal/forms/forms.ts"],"sourcesContent":["import { getTrad } from '../../../utils';\nimport { commonBaseForm } from '../attributes/commonBaseForm';\nimport { attributesForm } from '../attributes/form';\nimport { nameField } from '../attributes/nameField';\nimport { attributeTypes } from '../attributes/types';\nimport { createCategorySchema } from '../category/createCategorySchema';\nimport { categoryForm } from '../category/form';\nimport { componentForm } from '../component/componentForm';\nimport { createComponentSchema } from '../component/createComponentSchema';\nimport { contentTypeForm } from '../contentType/contentTypeForm';\nimport { createContentTypeSchema } from '../contentType/createContentTypeSchema';\nimport { dynamiczoneForm } from '../dynamiczoneForm';\n\nimport { addItemsToFormSection, FormTypeOptions } from './utils/addItemsToFormSection';\nimport { createComponentCollectionName } from './utils/createCollectionName';\nimport { Attribute, getUsedAttributeNames, SchemaData } from './utils/getUsedAttributeNames';\n\nimport type { Internal } from '@strapi/types';\n\ntype ContentType = {\n  schema: {\n    singularName: string;\n    pluralName: string;\n    collectionName: string;\n  };\n};\n\nexport type SchemaParams = {\n  schemaAttributes: any;\n  attributeType: keyof typeof attributeTypes;\n  customFieldValidator: any;\n  reservedNames: {\n    attributes: Array<string>;\n  };\n  schemaData: any;\n  ctbFormsAPI: any;\n};\n\ntype Base<TAttributesFormType extends 'base' | 'advanced'> = {\n  data: any;\n  type: keyof (typeof attributesForm)[TAttributesFormType];\n  step: string;\n  attributes: any;\n  extensions: any;\n  forTarget: string;\n};\n\nexport const forms = {\n  customField: {\n    schema({\n      schemaAttributes,\n      attributeType,\n      customFieldValidator,\n      reservedNames,\n      schemaData,\n      ctbFormsAPI,\n    }: SchemaParams) {\n      const usedAttributeNames = getUsedAttributeNames(schemaAttributes, schemaData);\n\n      let attributeShape;\n      if (attributeType === 'relation') {\n        attributeShape = attributeTypes[attributeType](\n          usedAttributeNames,\n          reservedNames.attributes,\n          [],\n          { initialData: {}, modifiedData: {} }\n        );\n      } else {\n        attributeShape = attributeTypes[attributeType](\n          usedAttributeNames,\n          reservedNames.attributes\n        );\n      }\n\n      return ctbFormsAPI.makeCustomFieldValidator(\n        attributeShape,\n        customFieldValidator,\n        usedAttributeNames,\n        reservedNames.attributes,\n        schemaData\n      );\n    },\n    form: {\n      base({ customField }: any) {\n        // Default section with required name field\n        const sections: FormTypeOptions = [{ sectionTitle: null, items: [nameField] }];\n\n        if (customField.options?.base) {\n          addItemsToFormSection(customField.options.base, sections);\n        }\n\n        return { sections };\n      },\n      advanced({ customField, data, step, extensions, ...rest }: any) {\n        // Default section with no fields\n        const sections: FormTypeOptions = [{ sectionTitle: null, items: [] }];\n        const injectedInputs = extensions.getAdvancedForm(['attribute', customField.type], {\n          data,\n          type: customField.type,\n          step,\n          ...rest,\n        });\n\n        if (customField.options?.advanced) {\n          addItemsToFormSection(customField.options.advanced, sections);\n        }\n\n        if (injectedInputs) {\n          const extendedSettings = {\n            sectionTitle: {\n              id: getTrad('modalForm.custom-fields.advanced.settings.extended'),\n              defaultMessage: 'Extended settings',\n            },\n            items: injectedInputs,\n          };\n\n          sections.push(extendedSettings);\n        }\n\n        return { sections };\n      },\n    },\n  },\n  attribute: {\n    schema(\n      currentSchema: any,\n      attributeType: keyof typeof attributeTypes,\n      reservedNames: {\n        attributes: Array<string>;\n      },\n      alreadyTakenTargetContentTypeAttributes: Array<Attribute>,\n      options: SchemaData,\n      extensions: {\n        makeValidator: any;\n      }\n    ) {\n      // Get the attributes object on the schema\n      const attributes: Array<Attribute> = currentSchema?.schema?.attributes ?? [];\n      const usedAttributeNames = getUsedAttributeNames(attributes, options);\n\n      try {\n        const attributeShape = attributeTypes[attributeType](\n          usedAttributeNames,\n          reservedNames.attributes,\n          alreadyTakenTargetContentTypeAttributes,\n          options\n        );\n\n        return extensions.makeValidator(\n          ['attribute', attributeType],\n          attributeShape,\n          usedAttributeNames,\n          reservedNames.attributes,\n          alreadyTakenTargetContentTypeAttributes,\n          options\n        );\n      } catch (err) {\n        console.error('Error yup build schema', err);\n\n        return attributeTypes.default(usedAttributeNames, reservedNames.attributes);\n      }\n    },\n    form: {\n      advanced({ data, type, step, extensions, ...rest }: Base<'advanced'>) {\n        try {\n          const baseForm = attributesForm.advanced[type](data, step).sections;\n          const itemsToAdd = extensions.getAdvancedForm(['attribute', type], {\n            data,\n            type,\n            step,\n            ...rest,\n          });\n\n          const sections = baseForm.reduce((acc: Array<any>, current: any) => {\n            if (current.sectionTitle === null) {\n              acc.push(current);\n            } else {\n              acc.push({ ...current, items: [...current.items, ...itemsToAdd] });\n            }\n\n            return acc;\n          }, []);\n          // IF we want a dedicated section for the plugins\n          // const sections = [\n          //   ...baseForm,\n          //   {\n          //     sectionTitle: { id: 'Zone pour plugins', defaultMessage: 'Zone pour plugins' },\n          //     items: itemsToAdd,\n          //   },\n          // ];\n\n          return { sections };\n        } catch (err) {\n          console.error(err);\n\n          return { sections: [] };\n        }\n      },\n      base({ data, type, step, attributes }: Base<'base'>) {\n        try {\n          return attributesForm.base[type](data, step, attributes);\n        } catch (err) {\n          return commonBaseForm;\n        }\n      },\n    },\n  },\n  contentType: {\n    schema(\n      alreadyTakenNames: Array<string>,\n      isEditing: boolean,\n      ctUid: Internal.UID.ContentType,\n      reservedNames: {\n        models: any;\n      },\n      extensions: any,\n      contentTypes: Record<string, ContentType>\n    ) {\n      const singularNames = Object.values(contentTypes).map((contentType) => {\n        return contentType.schema.singularName;\n      });\n\n      const pluralNames = Object.values(contentTypes).map((contentType: any) => {\n        return contentType?.schema?.pluralName ?? '';\n      });\n\n      const takenNames = isEditing\n        ? alreadyTakenNames.filter((uid) => uid !== ctUid)\n        : alreadyTakenNames;\n\n      const takenSingularNames = isEditing\n        ? singularNames.filter((singName) => {\n            const { schema } = contentTypes[ctUid];\n\n            return schema.singularName !== singName;\n          })\n        : singularNames;\n\n      const takenPluralNames = isEditing\n        ? pluralNames.filter((pluralName) => {\n            const { schema } = contentTypes[ctUid];\n\n            return schema.pluralName !== pluralName;\n          })\n        : pluralNames;\n\n      // return the array of collection names not all normalized\n      const collectionNames = Object.values(contentTypes).map((contentType) => {\n        return contentType?.schema?.collectionName ?? '';\n      });\n\n      const takenCollectionNames = isEditing\n        ? collectionNames.filter((collectionName) => {\n            const { schema } = contentTypes[ctUid];\n            const currentCollectionName = schema.collectionName;\n\n            return collectionName !== currentCollectionName;\n          })\n        : collectionNames;\n\n      const contentTypeShape = createContentTypeSchema({\n        usedContentTypeNames: takenNames,\n        reservedModels: reservedNames.models,\n        singularNames: takenSingularNames,\n        pluralNames: takenPluralNames,\n        collectionNames: takenCollectionNames,\n      });\n\n      // FIXME\n      return extensions.makeValidator(\n        ['contentType'],\n        contentTypeShape,\n        takenNames,\n        reservedNames.models,\n        takenSingularNames,\n        takenPluralNames\n      );\n    },\n    form: {\n      base({ actionType }: any) {\n        if (actionType === 'create') {\n          return contentTypeForm.base.create();\n        }\n\n        return contentTypeForm.base.edit();\n      },\n      advanced({ extensions }: any) {\n        const baseForm = contentTypeForm.advanced\n          .default()\n          .sections.map((section) => section.items)\n          .flat();\n        const itemsToAdd = extensions.getAdvancedForm(['contentType']);\n\n        return {\n          sections: [\n            {\n              items: [...baseForm, ...itemsToAdd],\n            },\n          ],\n        };\n      },\n    },\n  },\n  component: {\n    schema(\n      alreadyTakenAttributes: Array<Internal.UID.Component>,\n      componentCategory: string,\n      reservedNames: {\n        models: any;\n      },\n      isEditing = false,\n      components: Record<string, any>,\n      componentDisplayName: string,\n      compoUid: Internal.UID.Component | null = null\n    ) {\n      const takenNames = isEditing\n        ? alreadyTakenAttributes.filter((uid: Internal.UID.Component) => uid !== compoUid)\n        : alreadyTakenAttributes;\n      const collectionNames = Object.values(components).map((component: any) => {\n        return component?.schema?.collectionName;\n      });\n\n      const currentCollectionName = createComponentCollectionName(\n        componentDisplayName,\n        componentCategory\n      );\n\n      const takenCollectionNames = isEditing\n        ? collectionNames.filter((collectionName) => collectionName !== currentCollectionName)\n        : collectionNames;\n\n      return createComponentSchema(\n        takenNames,\n        reservedNames.models,\n        componentCategory,\n        takenCollectionNames,\n        currentCollectionName\n      );\n    },\n    form: {\n      advanced() {\n        return {\n          sections: componentForm.advanced(),\n        };\n      },\n      base() {\n        return {\n          sections: componentForm.base(),\n        };\n      },\n    },\n  },\n  addComponentToDynamicZone: {\n    form: {\n      advanced() {\n        return dynamiczoneForm.advanced.default();\n      },\n      base({ data }: any) {\n        const isCreatingComponent = data?.createComponent ?? false;\n\n        if (isCreatingComponent) {\n          return dynamiczoneForm.base.createComponent();\n        }\n\n        return dynamiczoneForm.base.default();\n      },\n    },\n  },\n  editCategory: {\n    schema(allCategories: Array<any>, initialData: any) {\n      const allowedCategories = allCategories\n        .filter((cat) => cat !== initialData.name)\n        .map((cat) => cat.toLowerCase());\n\n      return createCategorySchema(allowedCategories);\n    },\n    form: {\n      advanced: () => ({ sections: [] }),\n      base() {\n        return categoryForm.base;\n      },\n    },\n  },\n};\n"],"names":["forms","customField","schema","schemaAttributes","attributeType","customFieldValidator","reservedNames","schemaData","ctbFormsAPI","usedAttributeNames","getUsedAttributeNames","attributeShape","attributeTypes","attributes","initialData","modifiedData","makeCustomFieldValidator","form","base","sections","sectionTitle","items","nameField","options","addItemsToFormSection","advanced","data","step","extensions","rest","injectedInputs","getAdvancedForm","type","extendedSettings","id","getTrad","defaultMessage","push","attribute","currentSchema","alreadyTakenTargetContentTypeAttributes","makeValidator","err","console","error","default","baseForm","attributesForm","itemsToAdd","reduce","acc","current","commonBaseForm","contentType","alreadyTakenNames","isEditing","ctUid","contentTypes","singularNames","Object","values","map","singularName","pluralNames","pluralName","takenNames","filter","uid","takenSingularNames","singName","takenPluralNames","collectionNames","collectionName","takenCollectionNames","currentCollectionName","contentTypeShape","createContentTypeSchema","usedContentTypeNames","reservedModels","models","actionType","contentTypeForm","create","edit","section","flat","component","alreadyTakenAttributes","componentCategory","components","componentDisplayName","compoUid","createComponentCollectionName","createComponentSchema","componentForm","addComponentToDynamicZone","dynamiczoneForm","isCreatingComponent","createComponent","editCategory","allCategories","allowedCategories","cat","name","toLowerCase","createCategorySchema","categoryForm"],"mappings":"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"}