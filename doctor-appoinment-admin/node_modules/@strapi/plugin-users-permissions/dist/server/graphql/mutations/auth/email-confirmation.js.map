{"version":3,"file":"email-confirmation.js","sources":["../../../../../server/graphql/mutations/auth/email-confirmation.js"],"sourcesContent":["'use strict';\n\nconst { toPlainObject } = require('lodash/fp');\n\nconst { checkBadRequest } = require('../../utils');\n\nmodule.exports = ({ nexus, strapi }) => {\n  const { nonNull } = nexus;\n\n  return {\n    type: 'UsersPermissionsLoginPayload',\n\n    args: {\n      confirmation: nonNull('String'),\n    },\n\n    description: 'Confirm an email users email address',\n\n    async resolve(parent, args, context) {\n      const { koaContext } = context;\n\n      koaContext.query = toPlainObject(args);\n\n      await strapi\n        .plugin('users-permissions')\n        .controller('auth')\n        .emailConfirmation(koaContext, null, true);\n\n      const output = koaContext.body;\n\n      checkBadRequest(output);\n\n      return {\n        user: output.user || output,\n        jwt: output.jwt,\n      };\n    },\n  };\n};\n"],"names":["toPlainObject","require$$0","checkBadRequest","require$$1","emailConfirmation","nexus","strapi","nonNull","type","args","confirmation","description","resolve","parent","context","koaContext","query","plugin","controller","output","body","user","jwt"],"mappings":";;;;;;;;;;IAEA,MAAM,EAAEA,aAAa,EAAE,GAAGC,UAAAA;IAE1B,MAAM,EAAEC,eAAe,EAAE,GAAGC,eAAAA,EAAAA;AAE5BC,IAAAA,iBAAAA,GAAiB,CAAC,EAAEC,KAAK,EAAEC,MAAM,EAAE,GAAA;QACjC,MAAM,EAAEC,OAAO,EAAE,GAAGF,KAAAA;QAEpB,OAAO;YACLG,IAAM,EAAA,8BAAA;YAENC,IAAM,EAAA;AACJC,gBAAAA,YAAAA,EAAcH,OAAQ,CAAA,QAAA;AACvB,aAAA;YAEDI,WAAa,EAAA,sCAAA;AAEb,YAAA,MAAMC,OAAQC,CAAAA,CAAAA,MAAM,EAAEJ,IAAI,EAAEK,OAAO,EAAA;gBACjC,MAAM,EAAEC,UAAU,EAAE,GAAGD,OAAAA;gBAEvBC,UAAWC,CAAAA,KAAK,GAAGhB,aAAcS,CAAAA,IAAAA,CAAAA;gBAEjC,MAAMH,MAAAA,CACHW,MAAM,CAAC,mBACPC,CAAAA,CAAAA,UAAU,CAAC,MACXd,CAAAA,CAAAA,iBAAiB,CAACW,UAAAA,EAAY,IAAM,EAAA,IAAA,CAAA;gBAEvC,MAAMI,MAAAA,GAASJ,WAAWK,IAAI;gBAE9BlB,eAAgBiB,CAAAA,MAAAA,CAAAA;gBAEhB,OAAO;oBACLE,IAAMF,EAAAA,MAAAA,CAAOE,IAAI,IAAIF,MAAAA;AACrBG,oBAAAA,GAAAA,EAAKH,OAAOG;AACpB,iBAAA;AACK;AACL,SAAA;AACA,KAAA;;;;;;"}