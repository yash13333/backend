{"version":3,"file":"register.mjs","sources":["../../server/register.js"],"sourcesContent":["'use strict';\n\nconst fs = require('fs');\nconst path = require('path');\n\nconst authStrategy = require('./strategies/users-permissions');\nconst sanitizers = require('./utils/sanitize/sanitizers');\n\nmodule.exports = ({ strapi }) => {\n  strapi.get('auth').register('content-api', authStrategy);\n  strapi.sanitizers.add('content-api.output', sanitizers.defaultSanitizeOutput);\n\n  if (strapi.plugin('graphql')) {\n    require('./graphql')({ strapi });\n  }\n\n  if (strapi.plugin('documentation')) {\n    const specPath = path.join(__dirname, '../../documentation/content-api.yaml');\n    const spec = fs.readFileSync(specPath, 'utf8');\n\n    strapi\n      .plugin('documentation')\n      .service('override')\n      .registerOverride(spec, {\n        pluginOrigin: 'users-permissions',\n        excludeFromGeneration: ['users-permissions'],\n      });\n  }\n};\n"],"names":["fs","require$$0","path","require$$1","authStrategy","require$$2","sanitizers","require$$3","register","strapi","get","add","defaultSanitizeOutput","plugin","require$$4","specPath","join","__dirname","spec","readFileSync","service","registerOverride","pluginOrigin","excludeFromGeneration"],"mappings":";;;;;;;;;;;AAEA,IAAA,MAAMA,EAAKC,GAAAA,UAAAA;AACX,IAAA,MAAMC,IAAOC,GAAAA,UAAAA;AAEb,IAAA,MAAMC,YAAeC,GAAAA,uBAAAA,EAAAA;AACrB,IAAA,MAAMC,UAAaC,GAAAA,iBAAAA,EAAAA;IAEnBC,QAAiB,GAAA,CAAC,EAAEC,MAAM,EAAE,GAAA;AAC1BA,QAAAA,MAAAA,CAAOC,GAAG,CAAC,MAAQF,CAAAA,CAAAA,QAAQ,CAAC,aAAeJ,EAAAA,YAAAA,CAAAA;AAC3CK,QAAAA,MAAAA,CAAOH,UAAU,CAACK,GAAG,CAAC,oBAAA,EAAsBL,WAAWM,qBAAqB,CAAA;QAE5E,IAAIH,MAAAA,CAAOI,MAAM,CAAC,SAAY,CAAA,EAAA;YAC5BC,cAAqB,EAAA,CAAA;AAAEL,gBAAAA;AAAM,aAAA,CAAA;AAC9B;QAED,IAAIA,MAAAA,CAAOI,MAAM,CAAC,eAAkB,CAAA,EAAA;AAClC,YAAA,MAAME,QAAWb,GAAAA,IAAAA,CAAKc,IAAI,CAACC,SAAW,EAAA,sCAAA,CAAA;AACtC,YAAA,MAAMC,IAAOlB,GAAAA,EAAAA,CAAGmB,YAAY,CAACJ,QAAU,EAAA,MAAA,CAAA;YAEvCN,MACGI,CAAAA,MAAM,CAAC,eACPO,CAAAA,CAAAA,OAAO,CAAC,UACRC,CAAAA,CAAAA,gBAAgB,CAACH,IAAM,EAAA;gBACtBI,YAAc,EAAA,mBAAA;gBACdC,qBAAuB,EAAA;AAAC,oBAAA;AAAoB;AACpD,aAAA,CAAA;AACG;AACH,KAAA;;;;;;"}