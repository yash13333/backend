{"version":3,"file":"index.mjs","sources":["../../../../admin/src/components/UsersPermissions/index.jsx"],"sourcesContent":["import React, { forwardRef, memo, useImperativeHandle, useReducer } from 'react';\n\nimport { Flex, Grid, Typography } from '@strapi/design-system';\nimport PropTypes from 'prop-types';\nimport { useIntl } from 'react-intl';\n\nimport { UsersPermissionsProvider } from '../../contexts/UsersPermissionsContext';\nimport getTrad from '../../utils/getTrad';\nimport Permissions from '../Permissions';\nimport Policies from '../Policies';\n\nimport init from './init';\nimport reducer, { initialState } from './reducer';\n\nconst UsersPermissions = forwardRef(({ permissions, routes }, ref) => {\n  const { formatMessage } = useIntl();\n  const [state, dispatch] = useReducer(reducer, initialState, (state) =>\n    init(state, permissions, routes)\n  );\n\n  useImperativeHandle(ref, () => ({\n    getPermissions() {\n      return {\n        permissions: state.modifiedData,\n      };\n    },\n    resetForm() {\n      dispatch({ type: 'ON_RESET' });\n    },\n    setFormAfterSubmit() {\n      dispatch({ type: 'ON_SUBMIT_SUCCEEDED' });\n    },\n  }));\n\n  const handleChange = ({ target: { name, value } }) =>\n    dispatch({\n      type: 'ON_CHANGE',\n      keys: name.split('.'),\n      value: value === 'empty__string_value' ? '' : value,\n    });\n\n  const handleChangeSelectAll = ({ target: { name, value } }) =>\n    dispatch({\n      type: 'ON_CHANGE_SELECT_ALL',\n      keys: name.split('.'),\n      value,\n    });\n\n  const handleSelectedAction = (actionToSelect) =>\n    dispatch({\n      type: 'SELECT_ACTION',\n      actionToSelect,\n    });\n\n  const providerValue = {\n    ...state,\n    onChange: handleChange,\n    onChangeSelectAll: handleChangeSelectAll,\n    onSelectedAction: handleSelectedAction,\n  };\n\n  return (\n    <UsersPermissionsProvider value={providerValue}>\n      <Grid.Root gap={0} shadow=\"filterShadow\" hasRadius background=\"neutral0\">\n        <Grid.Item\n          col={7}\n          paddingTop={6}\n          paddingBottom={6}\n          paddingLeft={7}\n          paddingRight={7}\n          direction=\"column\"\n          alignItems=\"stretch\"\n        >\n          <Flex direction=\"column\" alignItems=\"stretch\" gap={6}>\n            <Flex direction=\"column\" alignItems=\"stretch\" gap={2}>\n              <Typography variant=\"delta\" tag=\"h2\">\n                {formatMessage({\n                  id: getTrad('Plugins.header.title'),\n                  defaultMessage: 'Permissions',\n                })}\n              </Typography>\n              <Typography tag=\"p\" textColor=\"neutral600\">\n                {formatMessage({\n                  id: getTrad('Plugins.header.description'),\n                  defaultMessage: 'Only actions bound by a route are listed below.',\n                })}\n              </Typography>\n            </Flex>\n            <Permissions />\n          </Flex>\n        </Grid.Item>\n        <Policies />\n      </Grid.Root>\n    </UsersPermissionsProvider>\n  );\n});\n\nUsersPermissions.propTypes = {\n  permissions: PropTypes.object.isRequired,\n  routes: PropTypes.object.isRequired,\n};\n\nexport default memo(UsersPermissions);\n"],"names":["UsersPermissions","forwardRef","permissions","routes","ref","formatMessage","useIntl","state","dispatch","useReducer","reducer","initialState","init","useImperativeHandle","getPermissions","modifiedData","resetForm","type","setFormAfterSubmit","handleChange","target","name","value","keys","split","handleChangeSelectAll","handleSelectedAction","actionToSelect","providerValue","onChange","onChangeSelectAll","onSelectedAction","_jsx","UsersPermissionsProvider","_jsxs","Grid","Root","gap","shadow","hasRadius","background","Item","col","paddingTop","paddingBottom","paddingLeft","paddingRight","direction","alignItems","Flex","Typography","variant","tag","id","getTrad","defaultMessage","textColor","Permissions","Policies","propTypes","PropTypes","object","isRequired","memo"],"mappings":";;;;;;;;;;;;AAcA,MAAMA,gBAAAA,iBAAmBC,WAAW,CAAC,EAAEC,WAAW,EAAEC,MAAM,EAAE,EAAEC,GAAAA,GAAAA;IAC5D,MAAM,EAAEC,aAAa,EAAE,GAAGC,OAAAA,EAAAA;IAC1B,MAAM,CAACC,KAAOC,EAAAA,QAAAA,CAAS,GAAGC,UAAAA,CAAWC,OAASC,EAAAA,YAAAA,EAAc,CAACJ,KAAAA,GAC3DK,IAAKL,CAAAA,KAAAA,EAAOL,WAAaC,EAAAA,MAAAA,CAAAA,CAAAA;IAG3BU,mBAAoBT,CAAAA,GAAAA,EAAK,KAAO;AAC9BU,YAAAA,cAAAA,CAAAA,GAAAA;gBACE,OAAO;AACLZ,oBAAAA,WAAAA,EAAaK,MAAMQ;AACrB,iBAAA;AACF,aAAA;AACAC,YAAAA,SAAAA,CAAAA,GAAAA;gBACER,QAAS,CAAA;oBAAES,IAAM,EAAA;AAAW,iBAAA,CAAA;AAC9B,aAAA;AACAC,YAAAA,kBAAAA,CAAAA,GAAAA;gBACEV,QAAS,CAAA;oBAAES,IAAM,EAAA;AAAsB,iBAAA,CAAA;AACzC;SACF,CAAA,CAAA;IAEA,MAAME,YAAAA,GAAe,CAAC,EAAEC,MAAQ,EAAA,EAAEC,IAAI,EAAEC,KAAK,EAAE,EAAE,GAC/Cd,QAAS,CAAA;YACPS,IAAM,EAAA,WAAA;YACNM,IAAMF,EAAAA,IAAAA,CAAKG,KAAK,CAAC,GAAA,CAAA;YACjBF,KAAOA,EAAAA,KAAAA,KAAU,wBAAwB,EAAKA,GAAAA;AAChD,SAAA,CAAA;IAEF,MAAMG,qBAAAA,GAAwB,CAAC,EAAEL,MAAQ,EAAA,EAAEC,IAAI,EAAEC,KAAK,EAAE,EAAE,GACxDd,QAAS,CAAA;YACPS,IAAM,EAAA,sBAAA;YACNM,IAAMF,EAAAA,IAAAA,CAAKG,KAAK,CAAC,GAAA,CAAA;AACjBF,YAAAA;AACF,SAAA,CAAA;IAEF,MAAMI,oBAAAA,GAAuB,CAACC,cAAAA,GAC5BnB,QAAS,CAAA;YACPS,IAAM,EAAA,eAAA;AACNU,YAAAA;AACF,SAAA,CAAA;AAEF,IAAA,MAAMC,aAAgB,GAAA;AACpB,QAAA,GAAGrB,KAAK;QACRsB,QAAUV,EAAAA,YAAAA;QACVW,iBAAmBL,EAAAA,qBAAAA;QACnBM,gBAAkBL,EAAAA;AACpB,KAAA;AAEA,IAAA,qBACEM,GAACC,CAAAA,wBAAAA,EAAAA;QAAyBX,KAAOM,EAAAA,aAAAA;gCAC/BM,IAAA,CAACC,KAAKC,IAAI,EAAA;YAACC,GAAK,EAAA,CAAA;YAAGC,MAAO,EAAA,cAAA;YAAeC,SAAS,EAAA,IAAA;YAACC,UAAW,EAAA,UAAA;;AAC5D,8BAAAR,GAAA,CAACG,KAAKM,IAAI,EAAA;oBACRC,GAAK,EAAA,CAAA;oBACLC,UAAY,EAAA,CAAA;oBACZC,aAAe,EAAA,CAAA;oBACfC,WAAa,EAAA,CAAA;oBACbC,YAAc,EAAA,CAAA;oBACdC,SAAU,EAAA,QAAA;oBACVC,UAAW,EAAA,SAAA;AAEX,oBAAA,QAAA,gBAAAd,IAACe,CAAAA,IAAAA,EAAAA;wBAAKF,SAAU,EAAA,QAAA;wBAASC,UAAW,EAAA,SAAA;wBAAUX,GAAK,EAAA,CAAA;;0CACjDH,IAACe,CAAAA,IAAAA,EAAAA;gCAAKF,SAAU,EAAA,QAAA;gCAASC,UAAW,EAAA,SAAA;gCAAUX,GAAK,EAAA,CAAA;;kDACjDL,GAACkB,CAAAA,UAAAA,EAAAA;wCAAWC,OAAQ,EAAA,OAAA;wCAAQC,GAAI,EAAA,IAAA;kDAC7B/C,aAAc,CAAA;AACbgD,4CAAAA,EAAAA,EAAIC,OAAQ,CAAA,sBAAA,CAAA;4CACZC,cAAgB,EAAA;AAClB,yCAAA;;kDAEFvB,GAACkB,CAAAA,UAAAA,EAAAA;wCAAWE,GAAI,EAAA,GAAA;wCAAII,SAAU,EAAA,YAAA;kDAC3BnD,aAAc,CAAA;AACbgD,4CAAAA,EAAAA,EAAIC,OAAQ,CAAA,4BAAA,CAAA;4CACZC,cAAgB,EAAA;AAClB,yCAAA;;;;0CAGJvB,GAACyB,CAAAA,WAAAA,EAAAA,EAAAA;;;;8BAGLzB,GAAC0B,CAAAA,QAAAA,EAAAA,EAAAA;;;;AAIT,CAAA,CAAA;AAEA1D,gBAAAA,CAAiB2D,SAAS,GAAG;IAC3BzD,WAAa0D,EAAAA,SAAAA,CAAUC,MAAM,CAACC,UAAU;IACxC3D,MAAQyD,EAAAA,SAAAA,CAAUC,MAAM,CAACC;AAC3B,CAAA;AAEA,yBAAA,cAAeC,KAAK/D,gBAAkB,CAAA;;;;"}